<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <title>Мій щоденник</title>
</head>
<body>

    <h1>Мій щоденник</h1>
    <p>Користувач: <strong>{{ user.username }}</strong></p>

    <p>
        <a href="/">На головну</a>
    </p>

    <hr>

    <form method="get">
        <h3>Фільтри:</h3>
        
        <label>Предмет:</label>
        <select name="subject">
            <option value="">-- Всі предмети --</option>
            {% for subject in subjects %}
                <option value="{{ subject.id }}" {% if active_subject == subject.id|stringformat:"s" %}selected{% endif %}>
                    {{ subject.name }}
                </option>
            {% endfor %}
        </select>

        &nbsp;

        <label>З дати:</label>
        <input type="date" name="date_from" value="{{ active_date_from }}">

        <label>По дату:</label>
        <input type="date" name="date_to" value="{{ active_date_to }}">

        <br><br>

        <button type="submit">Показати</button>
        <a href="{% url 'diary:student_grade_list' %}">Скинути</a>
    </form>

    <hr>

    <table border="1" cellpadding="8" cellspacing="0" width="100%">
        <thead>
            <tr style="background-color: #e0e0ff;">
                <th>Предмет</th>
                <th>Оцінка</th>
                <th>Дата</th>
                <th>Коментар</th>
                <th>Викладач</th>
            </tr>
        </thead>
        <tbody>
            {% for grade in grades %}
            <tr>
                <td>{{ grade.subject.name }}</td>
                <td><strong>{{ grade.score }}</strong></td>
                <td>{{ grade.created_at|date:"d.m.Y" }}</td>
                <td>{{ grade.comment|default:"-" }}</td>
                <td>{{ grade.teacher.username|default:"Система" }}</td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="5" align="center">Оцінок ще немає або вони не відповідають фільтрам.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    {% if is_paginated %}
    <div style="margin-top: 20px; text-align: center;">
        {% if page_obj.has_previous %}
            <a href="?page={{ page_obj.previous_page_number }}">&laquo; Попередня</a>
        {% endif %}
        
        <span>Сторінка {{ page_obj.number }} з {{ page_obj.paginator.num_pages }}</span>

        {% if page_obj.has_next %}
            <a href="?page={{ page_obj.next_page_number }}">Наступна &raquo;</a>
        {% endif %}
    </div>
    {% endif %}

</body>
</html>