<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <title>Список матеріалів</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
</head>
<body>

    <form method="get">
        <select name="category">
            <option value="">--- Категорія ---</option>
            {% for cat in categories %}
                <option value="{{ cat.id }}" {% if active_category == cat.id|stringformat:"s" %}selected{% endif %}>{{ cat.title }}</option>
            {% endfor %}
        </select>

        <select name="engine">
            <option value="">--- Рушій ---</option>
            {% for code, name in engines %}
                <option value="{{ code }}" {% if active_engine == code %}selected{% endif %}>{{ name }}</option>
            {% endfor %}
        </select>

        <select name="type">
            <option value="">--- Тип ---</option>
            {% for code, name in file_types %}
                <option value="{{ code }}" {% if active_type == code %}selected{% endif %}>{{ name }}</option>
            {% endfor %}
        </select>

        <button type="submit">Фільтрувати</button>
        <a href="{% url 'materials:material_list' %}">Скинути</a>
    </form>

    <hr>

    <ul>
        {% for material in materials %}
            <li>
                <i class="{{ material.get_icon }}"></i>

                <a href="{% url 'materials:material_detail' material.pk %}">
                    {{ material.title }}
                </a>

                <span class="badge {{ material.get_badge_color }}">
                    {{ material.get_engine_display }}
                </span>

                <small>({{ material.category.title }})</small>
            </li>
        {% empty %}
            <p>Матеріалів немає.</p>
        {% endfor %}
    </ul>

    {% if is_paginated %}
        <div>
            {% if page_obj.has_previous %}
                <a href="?page={{ page_obj.previous_page_number }}&{{ get_params_except_page }}">Попередня</a>
            {% endif %}
            
            <span>{{ page_obj.number }} / {{ page_obj.paginator.num_pages }}</span>

            {% if page_obj.has_next %}
                <a href="?page={{ page_obj.next_page_number }}&{{ get_params_except_page }}">Наступна</a>
            {% endif %}
        </div>
    {% endif %}

</body>
</html>