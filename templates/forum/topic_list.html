{% block content %}
<h1>–¢–µ–º–∏ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó: {{ category.name }}</h1>

{% if user.is_authenticated %}
    {% if category.is_open %}
        <p><a href="{% url 'forum:topic_create' category.id %}">–°—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–µ–º—É</a></p>
    {% else %}
        <p>–ö–∞—Ç–µ–≥–æ—Ä—ñ—è –∑–∞–∫—Ä–∏—Ç–∞ –¥–ª—è –Ω–æ–≤–∏—Ö —Ç–µ–º.</p>
    {% endif %}
{% endif %}

<div>
    <strong>–§—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏ –∑–∞ —Ç–µ–≥–∞–º–∏:</strong>
    <a href="{% url 'forum:topic_list_by_category' category.id %}" 
       style="{% if not selected_tag %}font-weight: bold; text-decoration: underline;{% endif %}">
        –í—Å—ñ
    </a>
    {% for tag in all_tags %}
        | <a href="{% url 'forum:topic_list_by_category' category.id %}?tag={{ tag.slug }}">
            #{{ tag.name }}
        </a>
    {% endfor %}
</div>

{% if selected_tag %}
    <p> <strong>#{{ selected_tag.name }}</strong></p>
{% endif %}

<ul>
  {% for topic in topics %}
    <li>
      <h2>
        <a href="{% url 'forum:topic_detail' topic.pk %}">{{ topic.title }}</a>
        {% if topic.is_pinned %} üìå {% endif %}
        {% if topic.is_locked %} üîí {% endif %}
      </h2>
      
      {% if topic.tags.all %}
        <div>
          {% for tag in topic.tags.all %}
            <a href="{% url 'forum:topic_list_by_category' category.id %}?tag={{ tag.slug }}">
              #{{ tag.name }}
            </a>
          {% endfor %}
        </div>
      {% endif %}
      
      <p>
        –ê–≤—Ç–æ—Ä: {% if topic.author %}{{ topic.author.username }}{% else %}Unknown{% endif %}
      </p>
      <p>–í—ñ–¥–ø–æ–≤—ñ–¥—ñ: {{ topic.posts.count }}</p>
      <p>–û–Ω–æ–≤–ª–µ–Ω–æ: {{ topic.updated_at|date:"d.m.Y H:i" }}</p>
    </li>
  {% empty %}
    <li>
      {% if selected_tag %}
        –¢–µ–º –∑ —Ç–µ–≥–æ–º "{{ selected_tag.name }}" –Ω–µ–º–∞—î
      {% else %}
        –¢–µ–º –Ω–µ–º–∞—î
      {% endif %}
    </li>
  {% endfor %}
</ul>
{% endblock %}